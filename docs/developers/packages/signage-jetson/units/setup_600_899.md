# setup(600-899)

## **600_signage_jetson.sh**

このスクリプトは、`update_runner` / `update_manager` / `healthcheck` のヘルパーを配置し、**サイネージの更新管理を実行する systemd ユニット（`signage-update.service`）** を作成・更新します。  
ユニットは **oneshot** で起動し、`/etc/signage/secret.env` と `/etc/signage/signage.env` を読み込んだ上で、`config.sh` を `source` してから **`update_manager` を実行**します。

> 処理の流れ）

1) **ヘルパー配置**  
   `install_or_link` で `update_runner` / `update_manager` / `healthcheck` を所定パスへ配置（冪等）。

2) **ディレクトリ準備/権限整備**  
   - `mkdir -p "$WIFI_FLAG_DIR" "$USER_SYSTEMD_DIR"`  
   - `chown -R "$USERNAME:$USERNAME" "$WIFI_FLAG_DIR" "$HOME_DIR/.config/systemd"`  
   - `chmod 755 "$WIFI_FLAG_DIR"`

3) **systemd ユニット生成/更新（冪等）**  
   - `signage-update.service` を生成/更新。差分なしならスキップ。  

!!! note "注意"
    - **実効ユーザ**：ユニットに `User=` 指定が無いため **root** で実行されます。`USERNAME=${USERNAME}` というログ表記は**説明用**であり、実際にそのユーザで動かす場合はユニットに `User=${USERNAME}` を追加してください。  
    - **FailureAction=reboot**：`update_manager` の失敗で **再起動**が発生します。運用に応じて外す/変更（`none` など）を検討してください。  

---

## **610_install_trt_runtime.sh**

---

## **700_jetson_server.sh**

---

## **710_signage_server_port_override.sh**

---

## **720_nginx_admin_ui.sh**

---

## **800_firewall.sh**
