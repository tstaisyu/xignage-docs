# setup(200-599)

## **200_netplan_disable_nm.sh**

このスクリプトは、ネットワーク管理を **systemd-networkd に統一**するために、以下の処理を行います。  

1) **競合サービスの無効化**  
   `NetworkManager`, `wpa_supplicant`, `wpa_supplicant@${WIFI_INTERFACE}.service`

2) **systemd-networkd の有効化**  
   `systemctl enable/start systemd-networkd`

3) **`eth0` を DHCP4 有効にする netplan ファイルの作成 → 適用**  

- 新規作成時：600 パーミッションで保存 → `netplan apply`
- 既存と差分あり：上書き保存 → `netplan apply`
- 差分なし：スキップ

!!! note "注意"
    - **リモート実行時の断**: 本処理はネットワークレイヤを切り替えるため、SSH セッションが切断される可能性があります。コンソールでの実行を推奨します。
    - **DNS 構成**: `renderer: networkd` に切り替えると、`systemd-resolved` や NetworkManager の `resolv.conf` 管理と競合しません。別スクリプトで `resolv.conf` を immutable 化している場合は整合に注意してください。
    - **Wi-Fi 管理**: Wi-Fi は `systemd-networkd` + `.network`/`wpa_supplicant@.service` 等で別途構成します（本ファイルは **eth0 のみ**を扱います）。

---

## ****

---
